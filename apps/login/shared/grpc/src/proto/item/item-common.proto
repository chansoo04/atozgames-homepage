syntax = "proto3";

package item;

message Amount {
  string game = 1;
  string cash = 2;
}

message ItemType {
  string item_type_id = 1;
  string name = 2;
  string description = 3;
  string image = 4;
  string metadata = 5;
  string created_at = 6;
  string updated_at = 7;
}

message Item {
  string item_id = 1;
  string item_type_id = 2;
  string name = 3;
  string description = 4;
  string image_url = 5;
  string metadata = 6;
  string price = 7; // bigint
  string currency = 8;

  int32 effect_duration = 9; // 효과 지속 시간 (초) | null 이면 영구 적용
  EffectApplyType effect_apply_type = 10; // 효과 적용 방식

  int32 acquire_limit_by_day = 11; // 일일 취득 제한 횟수 | 0 이면 무제한
  int32 acquire_limit_by_week = 12; // 주간 취득 제한 횟수 | 0 이면 무제한
  int32 acquire_limit_by_month = 13; // 월간 취득 제한 횟수 | 0 이면 무제한

  int32 use_limit_by_day = 14; // 일일 사용 제한 횟수 | 0 이면 무제한
  int32 use_limit_by_week = 15; // 주간 사용 제한 횟수 | 0 이면 무제한
  int32 use_limit_by_month = 16; // 월간 사용 제한 횟수 | 0 이면 무제한

  bool is_consumable = 17; // 소모성 여부

  bool is_active = 18;
  string created_at = 19;
  string updated_at = 20;
  optional string payment_type = 21;
}

enum EffectApplyType {
  EFFECT_NONE = 0;
  EFFECT_NOT_EFFECTABLE = 1; // 효과 없음
  EFFECT_ON_ACQUIRE = 2; // 취득 시 즉시 적용
  EFFECT_ON_USE = 3; // 사용 시 적용
}

message ItemPack {
  string item_pack_id = 1;
  string name = 2;
  string description = 3;
  string image_url = 4;
  string metadata = 5;

  string in_app_item_id = 6; // 구매 시 사용할 인앱 상품 ID
  string currency = 7;
  string price = 8; // bigint
  string total_price = 9; // bigint
  int32 discount = 10; // 할인율
  int32 gain_percent = 11; // 증가율 : 패키지 구매 시 얼마나 이득인지 표시

  SellingState selling_state = 12; // 판매 형태 | 판매중, 판매 예정, 판매 일시 중지, 판매 종료
  string selling_start_at = 13; // 판매 시작 시간 | null 이면 즉시 판매 가능
  int32 selling_duration = 14; // 판매 기간 (초) | null 이면 무제한 판매
  string selling_end_at = 15; // 판매 종료 시간 | null 이면 무제한 판매

  int32 buy_limit_by_day = 16; // 일일 구매 제한 횟수 | 0 이면 무제한
  int32 buy_limit_by_week = 17; // 주간 구매 제한 횟수 | 0 이면 무제한
  int32 buy_limit_by_month = 18; // 월간 구매 제한 횟수 | 0 이면 무제한

  bool is_refundable = 19; // 환불 가능 여부
  bool is_active = 20;
  string created_at = 21;

  repeated ItemPackElement elements = 22;
}

enum SellingState {
  SELL_NONE = 0;
  SELL_ON_SALE = 1; // 판매중
  SELL_COMING_SOON = 2; // 판매 예정
  SELL_PAUSED = 3; // 판매 일시 중지
  SELL_END = 4; // 판매 종료
}

message ItemPackElement {
  int32 item_pack_element_id = 1;
  string item_pack_id = 2;
  string child_pack_id = 3;
  string item_id = 4;
  string amount = 5; // bigint
  int32 order = 6;
  string created_at = 7;
  string updated_at = 8;

  Item item = 9;
  ItemPack child_pack = 10;
}

message InAppItem {
  int32 in_app_item_id = 1;
  string platform = 2; // android, ios, web
  string name = 3;
  string description = 4;
  string currency = 5; // KRW, USD
  int32 price = 6;

  bool is_active = 7;
  string created_at = 8;
  string updated_at = 9;
}

message PostBox {
  int32 postbox_id = 1;
  string account_id = 2;
  string sender_id = 3;
  string message = 4;
  string item_pack_id = 5;
  string item_id = 6;
  string amount = 7;
  string cash = 8;
  string game = 9;
  PostType type = 10;
  PostBoxState state = 11;
  bool is_visible = 12; // 노출 여부 | 삭제처리
  string limited_at = 13; // 삭제 시간
  string opened_at = 14; // 열람 시간
  string received_at = 15; // 수령 시간
  string created_at = 16;
  string updated_at = 17;
}

enum PostType {
  POST_NONE = 0;
  POST_SYSTEM = 1; // 시스템 메시지
  POST_REWARD = 2; // 보상
  POST_REFUND = 3; // 환불
  POST_OVERFLOW = 4; // 소지금 넘침
  POST_GAME_OVERFLOW = 5; // 게임 취득 금액 넘침
  POST_INAPP_RECEIPT = 6; // 인앱 영수증
  POST_PURCHASE_RECEIPT = 7; // 구매 영수증
  POST_MESSAGE = 8; // 메시지
  POST_TRANSFER = 9; // 이동
  POST_OTHER = 10; // 기타
}

enum PostBoxState {
  POST_BOX_NONE = 0;
  POST_BOX_NOT_OPEN = 1; // 미열람
  POST_BOX_NOT_RECEIVED = 2; // 미수령
  POST_BOX_SOME_RECEIVED = 3; // 일부 수령
  POST_BOX_RECEIVED = 4; // 수령
  POST_BOX_EXPIRED = 5; // 만료
}

message Inventory {
  int32 inventory_id = 1;
  string account_id = 2;
  string item_id = 3;
  string item_type_id = 4;
  int32 amount = 5;

  bool is_effective = 6; // 효과 적용 여부
  string effect_start_at = 7; // 효과 적용 시작 시간
  string effect_updated_at = 8; // 효과 적용 갱신 시간
  string effect_end_at = 9; // 효과 적용 종료 시간
  int32 effect_total_time = 10; // 총 효과 적용 시간 (초)

  int32 acquire_by_day = 11; // 일일 취득 수
  int32 acquire_by_week = 12; // 주간 취득 수
  int32 acquire_by_month = 13; // 월간 취득 수
  int32 acquire_total = 14; // 총 취득 수
  string last_acquired_at = 15; // 마지막 취득 시간

  int32 use_by_day = 16; // 일일 사용 수
  int32 use_by_week = 17; // 주간 사용 수
  int32 use_by_month = 18; // 월간 사용 수
  int32 use_total = 19; // 총 사용 수
  string last_used_at = 20; // 마지막 사용 시간

  string created_at = 21;
  string updated_at = 22;

  Item item = 23;
}

message Reward {
  string reward_id = 1;
  string reward_type = 2;
  string name = 3;
  string description = 4;
  string value = 5;
  string condition = 6;
  string created_at = 7;
  string updated_at = 8;
}

message PaidReward {
  string tx_group_id = 1;
  string transaction_id = 2;
  string reward_id = 3;
  string reward_type = 4;
  string paid_at = 5;
}

message DefaultStringIdRequest {
  string id = 1;
}

message DefaultIntIdRequest {
  int32 id = 1;
}

message DefaultResponse {
  bool success = 1;
  string error_message = 2;
}

message EmptyRequest {
}

message EmptyResponse {
}

enum TransactionType {
  TX_NONE = 0;
  TX_USE = 1 ; // 사용
  TX_INAPP_PURCHASE = 2; // inApp 구매
  TX_STORE_PURCHASE = 3; // 상점구매
  TX_REWARD = 4; // 보상
  TX_TRANSFER = 5; // 이동
  TX_DESTROY = 6; // 파괴
  TX_DISCARD = 7; // 폐기, 만료
  TX_OTHER = 8; // 기타
}
